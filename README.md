$url=parse_url($_SERVER['REQUEST_URI']); DEFINE('MySQL_MANAGER_PATH', $url['path']); class database { function __destruct(){ if($this->use_mysqli){ } else { return mysql_close($this->con);} } function __construct($host, $user, $pass, $db=false){ $this->use_mysqli=function_exists("mysqli_connect"); $this->database($host, $user, $pass, $db);} function database($host, $user, $pass, $db=false){ $this->res=false; $this->con=false; $this->query=""; $this->error=""; $this->debug=false; $this->result=false; $this->sn=false; $this->lastQuery=""; $this->total_queries=0; $this->host=$host; $this->user=$user; $this->pass=$pass; if($db){ $this->select_db($db);} else { $this->con=new mysqli($host,$user,$pass, "");} } function select_db($db){ if($this->use_mysqli){ $this->con=new mysqli($this->host,$this->user,$this->pass, $db) or die ('Sorry, can not connect to the database');} else { $this->con=@mysql_connect($host,$user,$pass) or die ('Sorry, can not connect to the database'); @mysql_select_db($db, $this->con) or die ('Sorry, can not connect to the database');} } function push($table, $waardes, $new, $where=false){ if(is_array($waardes) && $table){ $query=Array(); foreach($waardes as $key => $value){ if(!is_numeric($value)){ $value="'".$this->escape($value)."'";} $query[]="`".$key."`=".$value."";} if($new){ $sql="insert into `".$table."` set ".implode(",",$query).""; $sql=trim($sql).";";} else { $where=($where)?"WHERE ".$where."":""; $sql="update `".$table."` set ".implode(",",$query)." ".$where.""; $sql=trim($sql).";";} $this->query=$sql; return $this->query($sql);} } function fetch($res=false){ if($this->use_mysqli){ return $res->fetch_array(MYSQLI_ASSOC);} else { return mysql_fetch_assoc($res);} } function fetch2array($res){ $data2=array(); if(is_string($res)){ $res=$this->query($res);} while($data=$this->fetch($res)){ $data2[]=$data;} return $data2;} function error(){ if($this->use_mysqli){ return $this->con->error;} else { return mysql_error();} } function num_rows($res=false){ if($this->use_mysqli){ return $res->num_rows;} else { if($res==$this || $res==false){ return mysql_num_rows($this->result);} else { return mysql_num_rows($res);} } } function query($sql, $values=array()){ if(count($values)){ foreach($values as $key => $val){ if(substr($key, 0, 1)=="[" && substr($key, -1)=="]"){ list($type, $field)=explode(":", $key); if($type=="s"){ $val=$this->escape($val);} elseif($type=="i"){ $val=$val * 1;} $sql=str_replace($key, $val, $sql);} } } $this->lastQuery=$sql; if($this->use_mysqli){ $this->result=$this->con->query($sql) ; $this->error=$this->con->error;} else { $this->result=mysql_query($sql, $this->con) ; $this->error=mysql_error();} $this->total_queries++; if($this->error ){ $errorsql=$sql; $errorsql=str_ireplace("select ","SELECT <br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace("where","<br>WHERE<br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace(" and ","<br> &nbsp;&nbsp;&nbsp;AND ",$errorsql); $errorsql=str_ireplace(",",",<br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace(",<br>&nbsp;&nbsp;&nbsp; ",",<br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace(" or ","<br> &nbsp;&nbsp;&nbsp;OR ",$errorsql); $errorsql=str_ireplace(" from ","<br> FROM <br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace(" order by ","<br> ORDER BY <br>&nbsp;&nbsp;&nbsp;",$errorsql); $errorsql=str_ireplace("(","<br>(<br>",$errorsql); $errorsql=str_ireplace(")","<br>)<br>",$errorsql); $trace=debug_backtrace(); $line=$trace[0]; echo "<div ondblclick=\"document.getElementById('myerror_".md5($sql)."').style.display='';\" style='float:left;width:100%;box-sizing:border-box; font-family: arial; backround-color:#ff4c79; color: #000; padding:20px; border:2px solid #8c0023;'>"; echo "<b>MySQL error ".$line['file']." on line ".$line["line"]." </b><br>"; echo $errorsql . "<br>"; echo "<hr>"; echo $this->error; echo "<hr>"; echo "<div style='display: none' id='myerror_".md5($sql)."'>"; foreach($trace as $line){ echo "<pre style=' font-family: arial;'><b>".$line["file"]."</b><br> at line <b>".$line["line"]."</b> using function <b>".$line['function']." (".implode(", ",$line['args']).")</b></pre><br>";} echo "</div>"; echo "</div>"; exit;} return $this->result;} function escape($text){ if($this->use_mysqli){ return $this->con->escape_string($text);} else { return mysql_real_escape_string($text);} } function insert_id(){ if($this->use_mysqli){ return $this->con->insert_id;} else { return mysql_insert_id();} } function getQueryInfo(){ return $this->lastQuery."<br>\n".$this->error;} function result($res, $row=0, $column=0){ if($this->use_mysqli){ $res->data_seek($row); $datarow=$res->fetch_array(); return $datarow[$column];} else { return mysql_result($res, $row, $column);} } function insert($table, $data){ $sql=array(); foreach($data as $field => $value){ $sql[]="`".$field."`='".$this->escape($value)."'";} $sql="insert into `".$table."` set ".implode(",",$sql).""; $this->query($sql); return $this->insert_id();} function update($table, $data, $where){ $sql=array(); foreach($data as $field => $value){ $sql[]="`".$field."`='".$this->escape($value)."'";} if(is_array($where)){ $where2=array(); foreach($where as $field => $value){ $where2[]="`".$field."`='".$this->escape($value)."'";} $sql="update `".$table."` set ".implode(",",$sql)." where ".implode(" and ",$where2)."";} elseif($where=="-1"){ $sql="update `".$table."` set ".implode(",",$sql)."";} else { $sql="update `".$table."` set ".implode(",",$sql)." where ".$where."";} $this->query($sql); return $this->insert_id();} function select($table,$fields="*" , $where=false, $order=false){ $this->select_res=$this->query($this->generate_select_sql($table, $fields, $where, $order)); echo mysql_error(); return $this->select_res;} function select_fetch($table,$fields="*" , $where=false, $order=false, $lastdata=false){ if(!$lastdata){ $this->resArray[md5($table.$fields.serialize($where).$order)]=$this->select($table, $fields, $where, $order);} return $this->fetch($this->resArray[md5($table.$fields.serialize($where).$order)]);} function select_with_pagination($table,$fields="*" , $where=false, $html,$html2,$currentpage, $limit, $order=false){ if($currentpage < 1){ $currentpage=1;} $sql=$this->generate_select_sql($table, $fields, $where, $order); $res=$this->query($sql); $total=$this->num_rows($res); $pages=ceil($total / $limit); unset($this->page); $this->page=array(); for($i=1; $i <= $pages; $i++){ if($currentpage==$i){ $this->page[]=str_replace("%s",$i,$html2);} else { $this->page[]=str_replace("%s",$i,$html);} } $start=($currentpage-1) * $limit; $sql .= " limit ".$start.",".$limit.""; return $this->query($sql);} function getPagination(){ return $this->page;} function delete($table , $where){ if(is_array($where)){ $where2=array(); foreach($where as $field => $value){ $where2[]="`".$field."`='".$this->escape($value)."'";} $sql="delete from `".$table."` where ".implode(" and ",$where2)."";} elseif($where=="-1"){ $sql="delete from `".$table."`";} else { $sql="delete from `".$table."` where ".$where."";} $this->query($sql);} function generate_select_sql($table,$fields="*" , $where=false, $order=false){ if(is_array($where)){ $where2=array(); foreach($where as $field => $value){ $where2[]="`".$field."`='".$this->escape($value)."'";} $sql="select ".$fields." from `".$table."` where ".implode(" and ",$where2)."";} elseif($where==false){ $sql="select ".$fields." from ".$table."";} else { $sql="select ".$fields." from ".$table." where ".$where."";} if($order){ $sql .= " order by ".$order."";} return $sql;} } error_reporting(E_NONE); session_start(); ob_start(); $version="1.002"; function escape($data){ if(get_magic_quotes_gpc()){ $data=stripslashes($data);} return $data;} $self=file_get_contents($_SERVER['SCRIPT_FILENAME']); if(isset($_POST['host']) && $_POST['host'] && isset($_POST['username']) && $_POST['username']){ $host=escape($_POST['host']); $username=escape($_POST['username']); $password=""; if(isset($_POST['password'])){ $password=escape($_POST['password']);} if($db=new database($host, $username, $password)){ $_SESSION['host']=$host; $_SESSION['username']=$username; $_SESSION['password']=$password; if(isset($_POST['database']) && $_POST['database']!="" && @$db->select_db($_POST['database'])){ $_SESSION['database']=$_POST['database'];} } else { $show_login_error=true; session_destroy();} } $h=explode("?>", $self); $hash=end($h); if(isset($_SESSION['username']) && isset($_SESSION['password']) && isset($_SESSION['host'])){ if(isset($_GET['database'])){ $_SESSION['database']=$_GET['database'];} $db=new database($_SESSION['host'], $_SESSION['username'], $_SESSION['password']); $database=""; if(isset($_SESSION['database'])){ $db->select_db($_SESSION['database']); $database=$_SESSION['database'];} } $hash2=md5(substr($self, 0, (strlen($hash) + 10) * -1)); if($_SERVER['HTTP_HOST']!="www.nu4.nl"){ if($hash!=$hash2){ echo base64_decode("PHA+U29ycnksIHRoaXMgZmlsZSBoYXMgYmVlbiBtb2RpZmllZC48L3A+DQo8cD5QbGVhc2UgZ28gdG8gPGEgaHJlZj0naHR0cDovL3d3dy5vbmVmaWxlc3FsLmNvbSc+T25lIEZpbGUgU1FMLmNvbTwvYT4gdG8gZG93bmxvYWQgYSBzYWZlIHZlcnNpb248L3A+DQo="); exit();} } else { $hash="a"; $hash2="a";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="Y3Nz" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}header("Content-type: text/css"); $offset=3600 * 24; header("Expires: " . gmdate("D, d M Y H:i:s", time() + $offset) . " GMT", true); header("Cache-Control: max-age=".$offset.", must-revalidate", true); header("Last-Modified: ". gmdate('D, d M Y H:i:s', filemtime(__FILE__) )." GMT", true); header("Pragma: Cache",true); ?> a { text-decoration: none; color: #000;} a img { border: 0px;} body { margin: 20px; font-family: calibri, helvetica, arial, verdana, tahoma, sans-serif; font-size: 12px;} td { font-size: 12px;} .tablestyle { border-collapse: collapse; border-left: 1px solid #666; border-top: 1px solid #666;} .tablestyle tr.head { background-color: #ccc; font-weight: bold;} .tablestyle td { border-right: 1px solid #666; border-bottom: 1px solid #666; padding: 5px; font-size: 12px;} a:hover { color: #000088; text-decoration: underline;} a.button { float: left; padding-left: 20px; padding-right: 20px; color: #fff; background-color: #5d5da1; font-weight: bold; padding-top: 5px; padding-bottom: 5px; margin-right: 2px; text-decoration: none; margin-top: 5px;} a.button:hover { background-color: #2d2da1; color: #fff !important;} <?php exit();} if(isset($_GET['page']) && base64_encode($_GET['page'])=="ZGVsZXRl" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_GET['where'])){ $where=array(); if(is_array($_GET['where'])){ foreach($_GET['where'] as $key => $value){ if($value=="null"){ } else { $where[]="md5(`".$key."`)='".($value)."'";} } } $sql="delete from `".$_GET['table']."` where ".implode(" AND ",$where).""; $res=$db->query($sql); echo "<script>alert('The record has been deleted'); self.location='?page=show_options&table=".$_GET['table']."'; window.top.frames['contentFrame'].location=window.top.frames['contentFrame'].location; </script>";} } if(isset($_GET['page']) && base64_encode($_GET['page'])=="ZHJvcA==" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_POST) && isset($_POST['yes'])){ $db->query("drop table `".$_GET['table']."`"); echo "<script>window.top.frames['topFrame'].location='?page=show_options&table=".$_GET['table']."'; window.top.frames['left'].location=window.top.frames['left'].location; </script>"; exit("".$_GET['table']." has been deleted, this cannot be undone.");} echo "<form method=\"post\" action=\"".$_SERVER['REQUEST_URI']."\">"; echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "DROP TABLE `".$_GET['table']."`<br>"; echo "<br>"; echo "<h3>This table (".$_GET['table'].") and data will be deleted, are you sure?</h3><br>"; echo "<input type='submit' value=' Yes ' name='yes'> &nbsp; &nbsp; &nbsp; <input type='button' onclick=\"window.location='?page=show_data&table=".$_GET['table']."'\" value=' Cancel '>"; echo "</form>";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="ZWRpdA==" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; if(isset($_GET['where'])){ $where_url=""; $where=array(); if(is_array($_GET['where'])){ foreach($_GET['where'] as $key => $value){ if($value=="null"){ } else { $where[]="md5(`".$key."`)='".($value)."'";} $where_url .= "&where[".$key."]=".$value."";} } $sql="select * from `".$_GET['table']."` where ".implode(" AND ",$where).""; $res=$db->query($sql); $data=$db->fetch($res); $new=false;} else { $data=array(); $new=true;} $sql="show full columns from `".$_GET['table']."`"; $res=$db->query($sql); if(isset($_GET['where'])){ echo "<form action=\"?page=update&table=".$_GET['table']."&pg=".$_GET['pg']."".$where_url."\" method=\"post\">";} else { echo "<form action=\"?page=save_new&table=".$_GET['table']."&pg=".$_GET['pg']."\" method=\"post\">";} echo "<table class='tablestyle'>"; if($new){ echo "<tr class='head'><td colspan=3>Add New Row</td></tr>";} else { echo "<tr class='head'><td colspan=3>Edit row</td></tr>";} while($table_info=$db->fetch($res)){ if($new){ $data[$table_info['Field']]=$table_info['Default'];} echo "<tr>"; echo "<td>".$table_info['Field']." &nbsp;</td>"; echo "<td><select name='funcList[".$table_info['Field']."]'><option></option><option value='MD5'>MD5</option><option value='NOW'>NOW</option><option value='Date'>Date</option></select></td>"; if(substr($table_info['Type'], 0, 3)=="int" || substr($table_info['Type'], 0, 6)=="bigint" || substr($table_info['Type'], 0, 7)=="tinyint" || substr($table_info['Type'], 0, 8)=="smallint"){ echo "<td><input name=\"data[".$table_info['Field']."]\" type=\"text\" value=\"".htmlentities($data[$table_info['Field']])."\"></td>";} elseif(substr($table_info['Type'], 0, 5)=="float"){ echo "<td><input name=\"data[".$table_info['Field']."]\" type=\"text\" value=\"".htmlentities($data[$table_info['Field']])."\"></td>";} elseif(substr($table_info['Type'], 0, 4)=="char" || substr($table_info['Type'], 0, 7)=="varchar" || substr($table_info['Type'], 0, 4)=="text" || substr($table_info['Type'], 0, 8)=="longtext"){ $length=0; if(substr($table_info['Type'], -1)==")"){ preg_match("#\(([0-9]+)\)#si", $table_info['Type'], $length); $length=$length[1];} echo "<td><textarea ".($length ? "maxlength='".$length."'":"")." name=\"data[".$table_info['Field']."]\">".htmlentities($data[$table_info['Field']])."</textarea></td>";} elseif(substr($table_info['Type'], 0, 4)=="enum"){ $options=substr($table_info['Type'], 6); $options=substr($options,0, -2); $options= explode("','", $options); echo "<td><select name=\"data[".$table_info['Field']."]\"><option></option>"; foreach($options as $option){ echo "<option ".($option==$data[$table_info['Field']] ? "selected":"")." value=\"".htmlentities($option)."\">".htmlentities($option)."</option>\n";} echo "</select></td>";} elseif(substr($table_info['Type'], 0, 4)=="date"){ if($data[$table_info['Field']]==""){ $data[$table_info['Field']]="0000-00-00";} echo "<td><input name=\"data[".$table_info['Field']."]\" size='10' type=\"text\" value=\"".htmlentities($data[$table_info['Field']])."\"></td>";} elseif(substr($table_info['Type'], 0, 4)=="time"){ if($data[$table_info['Field']]==""){ $data[$table_info['Field']]="00:00";} echo "<td><input name=\"data[".$table_info['Field']."]\" size='10' type=\"text\" value=\"".htmlentities($data[$table_info['Field']])."\"></td>";} elseif(substr($table_info['Type'], 0, 4)=="datetime"){ if($data[$table_info['Field']]==""){ $data[$table_info['Field']]="0000-00-00 00:00:00";} echo "<td><input name=\"data[".$table_info['Field']."]\" size='20' type=\"text\" value=\"".htmlentities($data[$table_info['Field']])."\"></td>";} else { echo "<td>".$data[$table_info['Field']]." &nbsp;</td>";} echo "</tr>\n";} echo "</table><br><br>"; echo "<input type='submit' value=' Save '> &nbsp; "; echo "<input type='button' value=' Cancel ' onclick='history.back(-1);'>"; echo "</form>";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="ZXhwb3J0" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}header("Content-type: text/sql"); header("Content-disposition: attachment; filename=\"Export ".$_GET['table']." ".date("Y-m-d H:i:s")."\".sql"); $sql="show tables"; $res3=$db->query($sql); while($tdata=$db->fetch($res3)){ if($_GET['table']==$tdata[key($tdata)] || $_GET['table']==''){ $sql="show create table `".$tdata[key($tdata)]."`"; $res=$db->query($sql); $data=$db->fetch($res); echo "-- Table Name ".$tdata[key($tdata)]."\r\n"; echo "-- Export created at ".date("Y-m-d H:i:s")."\r\n"; echo "-- www.slomp.ca/mysql-manager/\r\n"; echo "\r\n"; echo "\r\n"; echo $data['Create Table'].";\r\n"; echo "\r\n\r\n"; $sql="select * from `".$tdata[key($tdata)]."`"; $res=$db->query($sql); while($data=$db->fetch($res)){ $fields=array(); $datas=array(); foreach($data as $key => $v){ $fields[]="`".$key."`"; if(strlen($v) > 500){ $datas[]="UNHEX('".bin2hex($v)."')";} else { $datas[]="'".$db->escape($v)."'";} } echo "insert into `".$tdata[key($tdata)]."` (".implode(",",$fields).") values (".implode(",",$datas).");\r\n";} echo "\r\n\r\n";} } } if(isset($_GET['page']) && base64_encode($_GET['page'])=="aW1hZ2VzL2Jyb3dzZS5wbmc=" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}header("content-type: image/png"); header("content-disposition: inline"); header("Expires: ".date("r", time() + 86400)." GMT"); echo base64_decode("iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAAK/INwWK6QAAAA9QTFRFAAAAAAAAZmZmmZnM////RM+6BgAAAAF0Uk5TAEDm2GYAAAAsSURBVAjXY2CAASYlMFBgYDI2MgYCZAZcysXJBQiADEcnR0FBEcpFYCbDAAAUnhJ5/QEafAAAAABJRU5ErkJggg=="); exit();} if(!isset($_GET['page']) || $_GET['page']==""){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_SESSION['host']) && $_SESSION['host']!=""){ ?> <html> <head> <title>MySQL Admin</title> </head> <frameset cols="200,*" frameborder="0" border="0" framespacing="0"> <frame src="<?php echo MySQL_MANAGER_PATH; ?>?page=left" name="left"> <frameset rows="100,*" frameborder="0" border="0" framespacing="0"> <frame name="topFrame" src="<?php echo MySQL_MANAGER_PATH; ?>?page=top" scrolling="no"> <frame name="contentFrame" src="<?php echo MySQL_MANAGER_PATH; ?>?page=welcome"> </frameset> </frameset> </html> <?php } else { ?> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html> <head> <title>Mysql Admin - Login</title> <link rel='stylesheet' href='?page=css' type="text/css"> </head> <body> <fieldset> <legend>Login </legend> <?php $_SERVER['REQUEST_URI']=str_replace("goto=","page=", $_SERVER['REQUEST_URI']); ?> <form action="<?php echo $_SERVER['REQUEST_URI']; ?>" method="post"> <table> <tr> <td>Host</td> <td> <input type="text" name="host"></td> </tr> <tr> <td>Username</td> <td> <input type="text" name="username"></td> </tr> <tr> <td>Password</td> <td> <input type="password" name="password"></td> </tr> <tr> <td>Database</td> <td> <input id='database_field' type="text" name="database"></td> </tr> <tr> <td> <input type="submit" name="login" value=" Login "></td> </tr> </table> <script> var loc=window.top.location.toString(); if(loc.indexOf('database=') > 0){ db=loc.split('database=')[1].split('&')[0]; document.getElementById('database_field').value=db;} </script> <?php if(isset($show_login_error) && $show_login_error==true){ echo "<font color='#ff0000'>Couldn't connect to the database, please try again</font>";} ?> </form> <br> <br> &copy; Copyright by <a href="http://www.slomp.ca">Slomp Technologies</a> </fieldset> </body> </html> <?php } } if(isset($_GET['page']) && base64_encode($_GET['page'])=="anMvYWRkTmV3Um93Lmpz" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}ob_clean(); header("Content-Type: text/javascript; name=\"addNewRow.js\""); header("content-disposition: inline; filename=\"addNewRow.js\""); header("Expires: ".date("r", time() + 86400)." GMT"); echo " \n \n \n \nvar rowno=0; \nfunction addNewRow(id,id2, oldId){ \n rowno++; \n b=3; \n document.getElementById(id).style.display =''; \n dup=document.getElementById(id).cloneNode(true); \n document.getElementById(id2).appendChild(dup); \n document.getElementById(id).style.display ='none'; \n elms=dup.getElementsByTagName(\"*\"); \n for(i=0; i < elms.length; i++){ \n if((elms[i].tagName==\"INPUT\" || elms[i].tagName==\"SELECT\" || elms[i].tagName==\"TEXTAREA\" ) && elms[i].name){ \n if(oldId!=null){ \n elms[i].name=\"update_\"+elms[i].name.substring(1).replace(\"[no]\",\"[\"+oldId+\"]\"); \n } else { \n elms[i].name=elms[i].name.substring(1).replace(\"[no]\",\"[\"+rowno+\"]\"); \n } \n if(arguments[b]){ \n if(elms[i].tagName==\"INPUT\" || elms[i].tagName==\"TEXTAREA\"){ \n if(elms[i].type && elms[i].type=='checkbox'){ \n if(arguments[b]==1){ \n elms[i].checked=true; \n } \n } else if(elms[i].type && elms[i].type=='radio'){ \n if(unescape(arguments[b])==elms[i].value){ \n elms[i].checked=true; \n } \n \n } else { \n elms[i].value=unescape(arguments[b]); \n } \n } else if(elms[i].tagName==\"SELECT\"){ \n \n for(x=0; x < elms[i].options.length; x++){ \n //alert(elms[i].options[x].value); \n \n if(elms[i].options[x].value==unescape(arguments[b])){ \n elms[i].selectedIndex=x; \n break; \n } \n } \n } \n } \n b++; \n \n } \n \n if(elms[i].id){ \n \n elms[i].id=elms[i].id.substring(1)+\"_\"+rowno+\"\"; \n } \n } \n } ";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="bGVmdA==" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}?> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html> <head> <title>Left</title> <link rel='stylesheet' href='?page=css' type='text/css'> <meta http-equiv="content-type" content="text/html;charset=iso-8859-1"> </head> <body bgcolor="#ccccff"> <?php $sql="show databases"; $res=$db->query($sql); echo "<select onchange=\"window.top.location=this.options[this.selectedIndex].value; \">\n"; echo "<option value=\"?\"> - select a database - </option>\n"; while($databases=$db->fetch($res)){ echo "<option ".($database==$databases['Database'] ? "selected":"")." value=\"".MySQL_MANAGER_PATH."?database=".$databases['Database']."\">".$databases['Database']."</option>\n";} echo "</select>\n"; echo "<br>"; echo "<hr>"; if($database){ echo "<a href='".MySQL_MANAGER_PATH."?page=new-table' target='contentFrame'>Create Table</a><br>"; echo "<a href='".MySQL_MANAGER_PATH."?page=sql' target='contentFrame'>SQL Query</a><br>";} echo "<a href='".MySQL_MANAGER_PATH."?page=phpinfo' target='contentFrame'>PHP info</a><br>"; echo "<a href='".MySQL_MANAGER_PATH."?page=export&table=' target='_blank'>Export all tables to SQL-File</a><br>"; echo "<a href='".MySQL_MANAGER_PATH."?page=logout' target='_top'>Logout</a>"; echo "<hr>"; if($database){ echo "<input style='width: 100%;' onkeyup=\"var t=this; if(b!=null){ clearTimeout(b);} var b=setTimeout(function(){ window.location='?page=left&like='+t.value+'' }, 1000);\" onchange=\"window.location='?page=left&like='+this.value+''\" value=\"".(isset($_GET['like']) ? escape($_GET['like']):"")."\">"; echo "<hr>"; echo "<br>"; echo "<table>"; $sql="show tables from `".$database."`"; if(isset($_GET['like']) && $_GET['like']){ $sql .= "like '%".addslashes(escape($_GET['like']))."%'";} $res=$db->query($sql); while($table_data=$db->fetch($res)){ echo "<tr><td nowrap='nowrap'><a onclick=\"window.top.frames['topFrame'].location='?page=show_options&table=".rawurlencode($table_data[key($table_data)])."'\" href=\"?page=show_data&amp;table=".rawurlencode($table_data[key($table_data)])."\" target=\"contentFrame\" title='Browse'><img src='?page=images/browse.png' alt='browse'></a></td><td nowrap='nowrap'><a onclick=\"window.top.frames['topFrame'].location='?page=show_options&table=".$table_data[key($table_data)]."'\" title='Structure' href=\"?page=show_structure&amp;table=".$table_data[key($table_data)]."\" target=\"contentFrame\">".$table_data[key($table_data)]."</a></td></tr>\n";} echo "</table><br><br>";} ?> <a target='_blank' href='https://www.slomp.nl'>&copy; Slomp Technologies - v <?php echo $version; ?></a> </body> </html> <?php } if(isset($_GET['page']) && base64_encode($_GET['page'])=="bG9nb3V0" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}session_destroy(); header("location: ?");} if(isset($_GET['page']) && base64_encode($_GET['page'])=="bmV3LXRhYmxl" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}?> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html> <head> <title>New Table</title> <?php ?> <script type="text/javascript" src="?page=js/addNewRow.js"></script> <link rel="stylesheet" href="<?php echo $_SERVER['SCRIPT_NAME']; ?>?page=css" type="text/css"> </head> <body> <?php $previous=""; $alter=array(); if(isset($_POST['update_field'])){ $changed=array(); $_POST['changed']=$_POST['changed'].";"; $changed=explode(";",$_POST['changed']); foreach($_POST['update_field'] as $key => $value){ if($_POST['update_field'][$key]=="*delete*"){ $alter[]="alter table `".$_GET['table']."` drop `".$key."` ";} else { if(in_array($key, $changed)){ $alter[]="alter table `".$_GET['table']."` CHANGE `".$key."` `".$_POST['update_field'][$key]."` ".$_POST['update_type'][$key]." ".($_POST['update_maxlength'][$key] ? "(".escape($_POST['update_maxlength'][$key]).")":"")." ".($_POST['update_default'][$key] ? "DEFAULT '".addslashes(escape($_POST['update_default'][$key]))."'":"")." ".(isset($_POST['update_not_null'][$key]) ? "NOT NULL":"")." ".$_POST['update_extra'][$key]." ".($previous ? "AFTER `".$previous."`":"")."";} $previous=$_POST['update_field'][$key];} } } if(isset($_POST['field'])){ $fields=array(); foreach($_POST['field'] as $key => $value){ if(trim($_POST['field'][$key]) && $_POST['field'][$key]!="*delete*"){ $fields[]="`".$_POST['field'][$key]."` ".$_POST['type'][$key]." ".($_POST['maxlength'][$key] ? "(".escape($_POST['maxlength'][$key]).")":"")." ".($_POST['default'][$key] ? "DEFAULT '".addslashes(escape($_POST['default'][$key]))."'":"")." ".(isset($_POST['not_null'][$key]) ? "NOT NULL":"")." ".$_POST['extra'][$key].""; if(isset($_GET['table'])){ $alter[]="alter table `".$_GET['table']."` ADD `".$_POST['field'][$key]."` ".$_POST['type'][$key]." ".($_POST['maxlength'][$key] ? "(".escape($_POST['maxlength'][$key]).")":"")." ".($_POST['default'][$key] ? "DEFAULT '".addslashes(escape($_POST['default'][$key]))."'":"")." ".(isset($_POST['not_null'][$key]) ? "NOT NULL":"")." ".$_POST['extra'][$key]." ".($previous ? "AFTER `".$previous."`":"").""; $previous=$_POST['field'][$key];} if($_POST['key'][$key]=="PRIMARY"){ $fields[]="PRIMARY KEY (`".$_POST['field'][$key]."`)";} if($_POST['key'][$key]=="UNIQUE"){ $fields[]="UNIQUE KEY (`".$_POST['field'][$key]."`)";} } } $sql_query="CREATE TABLE `".$_POST['tablename']."` (\r\n"; $sql_query .= implode(",\r\n", $fields); $sql_query .= ");"; if(isset($_GET['table'])){ foreach($alter as $s){ echo $s ."<br>"; $db->query($s); echo $db->error(); echo "<br>";} if($_GET['table']!=$_POST['tablename']){ $s="RENAME TABLE `".$_GET['table']."` TO `".$_POST['tablename']."`"; echo $s ."<br>"; $db->query($s); echo $db->error(); echo "<br>"; echo "<script> window.top.frames['left'].location=window.top.frames['left'].location; </script>"; echo "<script> window.top.frames['topFrame'].location='?page=show_options&table=".$_POST['tablename']."'; </script>"; echo "<script> this.location='?page=new-table&table=".$_POST['tablename']."'; </script>";} } else { echo "<pre>"; echo $sql_query; echo "</pre>"; $db->query($sql_query); if($db->error()){ echo $db->error();} else { echo "<br><br>The table has been created<br><br>"; echo "<script> window.top.frames['left'].location=window.top.frames['left'].location; </script>"; echo "<script> window.top.frames['topFrame'].location='?page=show_options&table=".$_POST['tablename']."'; </script>";} } } ?> <form action="<?php echo $_SERVER['REQUEST_URI']; ?>" method="post"> Table name: <br> <input type="text" name="tablename" value="<?php echo isset($_GET['table']) ? $_GET['table']:""; ?>"><br> <input type='hidden' name='changed'> <br> <table class='tablestyle'> <tr class='head'> <td> Table Field </td> <td> Type </td> <td> Length </td> <td> Default Value</td> <td> Not Null </td> <td> Extra </td> <td> Key </td> <td> &nbsp; </td> </tr> <tr id='m_example' style='display: none'> <td> <input type='text' name='_field[no]' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"></td> <td> <select name="_type[no]" onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"> <option value="VARCHAR">VARCHAR</option> <option value="INT">INT</option> <option value="TINYINT">TINYINT</option> <option value="TEXT">TEXT</option> <option value="SMALLINT">SMALLINT</option> <option value="MEDIUMINT">MEDIUMINT</option> <option value="INTEGER">INTEGER</option> <option value="REAL">REAL</option> <option value="DOUBLE">DOUBLE</option> <option value="FLOAT">FLOAT</option> <option value="DECIMAL">DECIMAL</option> <option value="NUMBERIC">NUMBERIC</option> <option value="DATE">DATE</option> <option value="TIME">TIME</option> <option value="TIMESTAMP">TIMESTAMP</option> <option value="DATETIME">DATETIME</option> <option value="YEAR">YEAR</option> <option value="CHAR">CHAR</option> <option value="BINARY">BINARY</option> <option value="VARBINARY">VARBINARY</option> <option value="TINYBLOB">TINYBLOB</option> <option value="MEDIUMBLOB">MEDIUMBLOB</option> <option value="LONGBLOB">LONGBLOB</option> <option value="TINYTEXT">TINYTEXT </option> <option value="ENUM">ENUM </option> <option value="SET">SET </option> <option value="BIT">BIT</option> <option value="BLOB">BLOB</option> </select> </td> <td> <input type='text' name='_maxlength[no]' size='5' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"></td> <td> <input type='text' name='_default[no]' size='5' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"></td> <td> <input type='checkbox' value=1 name='_not_null[no]' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"></td> <td> <select name='_extra[no]' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"><option></option><option value='auto_increment'>auto_increment</option></select></td> <td> <select name='_key[no]' onchange="this.form.changed.value=this.form.changed.value+';'+this.name.split('[')[1].split(']')[0];"><option></option><option value='UNIQUE'>UNIQUE</option><option value='PRIMARY'>PRIMARY</option></select></td> <td><a href='#' onclick="if(window.confirm('Are you sure?')){ this.parentNode.parentNode.getElementsByTagName('input')[0].value='*delete*'; this.parentNode.parentNode.style.display='none'; return false;} ">Delete</a></td> </tr> <tbody id='m_rows'></tbody> </table> <input type='button' onclick="addNewRow('m_example','m_rows');" value=' Add new Column '> <?php if(isset($_GET['table'])){ $sql="show full columns from `".$_GET['table']."`"; $res=$db->query($sql); while($data=$db->fetch($res)){ $type=explode("(", $data['Type']); $max=""; if(isset($type[1])){ $max=substr($type[1], 0, -1);} $type=strtoupper($type[0]); $data['Key']=str_replace("PRI","PRIMARY",$data['Key']); $data['Key']=str_replace("UNI","UNIQUE",$data['Key']); ?> <script>addNewRow('m_example','m_rows','<?php echo $data['Field']; ?>','<?php echo $data['Field']; ?>','<?php echo $type; ?>','<?php echo rawurlencode($max); ?>','<?php echo rawurlencode($data['Default']); ?>','<?php echo $data['Null']=='NO' ? '1':''; ?>','<?php echo $data['Extra']; ?>','<?php echo $data['Key']; ?>');</script><?php echo "\n"; ?> <?php } } ?> <script>addNewRow('m_example','m_rows');</script> <br> <br> <?php if(isset($_GET['table'])){ ?> <input type='submit' value=' Update Table '> <?php } else { ?> <input type='submit' value=' Create Table '> <?php } ?> </form> </body> </html> <?php } if(isset($_GET['page']) && base64_encode($_GET['page'])=="cGhwaW5mbw==" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_SESSION['username']) && isset($_SESSION['host'])){ phpinfo();} } if(isset($_GET['page']) && base64_encode($_GET['page'])=="c2F2ZV9uZXc=" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_POST['data']) && $_POST['data']){ $sql=array(); foreach($_POST['data'] as $field => $value){ $value="'".addslashes(escape($value))."'"; if($_POST['funcList']){ $value="".$_POST['funcList'][$field]."(".$value.")";} $sql[]="`".$field."`=".$value."";} } $sql="insert into `".$_GET['table']."` set ".implode(",",$sql).""; $db->query($sql); header("Location: ?page=show_data&table=".$_GET['table']."&pg=".$_GET['pg'].""); exit();} if(isset($_GET['page']) && base64_encode($_GET['page'])=="c2VhcmNo" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_POST['field'])){ $q=""; foreach($_POST['field'] as $key => $field){ if(trim($_POST['field'][$key])){ $o=escape($_POST['operator'][$key]); $o=str_replace("[value]",addslashes(escape($_POST['q'][$key])), $o); $q .= "`".$_POST['field'][$key]."` ".$o." ".$_POST['andor'][$key]."";} } if(substr($q, -3)=="and"){ $q=substr($q, 0, -3);} if(substr($q, -2)=="or"){ $q=substr($q, 0, -2);} $sql2="select * from `".$_GET['table']."` where ".$q.""; $db->query($sql2." limit 0,5"); if($db->error()){ echo "<br>"; echo "<strong>Error:</strong> ".$db->error()."<br><br>"; echo $sql2."<br><br>"; $test=$q." and";} else { header("location: ".MySQL_MANAGER_PATH."?page=show_data&q=".urlencode($q)."&table=".$_GET['table']."");} } echo "<link rel='stylesheet' href='".MySQL_MANAGER_PATH."?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; ?> <script type="text/javascript" src="<?php echo MySQL_MANAGER_PATH; ?>?page=js/addNewRow.js"></script> <?php echo "<form method='post'>"; echo "<table class='tablestyle'>"; echo "<tr class='head'>"; echo "<td>Field</td>"; echo "<td>Operator</td>"; echo "<td>Search</td>"; echo "<td>AND/OR</td>"; echo "</tr>"; echo "<tr id='s' style='display: none;'>"; echo "<td>"; echo "<select name='_field[no]'>"; echo "<option value=''>- ignore</option>"; $sql="show columns from `".$_GET['table']."`"; $res=$db->query($sql); while($data=$db->fetch($res)){ echo "<option value=\"".$data['Field']."\">".$data['Field']."</option>";} echo "<select>"; echo "</td>"; echo "<td>"; echo "<select name='_operator[no]'>"; echo "<option value=\"= '[value]'\">= '[value]'</option>"; echo "<option value='= [value]'>= [value]</option>"; echo "<option value='IS NULL'>IS NULL</option>"; echo "<option value=\"like '[value]'\">like '[value]'</option>"; echo "<option value=\"like '%[value]%'\">like '%[value]%'</option>"; echo "<option value=\"!= '[value]'\">!= '[value]'</option>"; echo "<option value=\"!= [value]\">!= [value]</option>"; echo "<option value=\"< [value]\">&lt; [value]</option>"; echo "<option value=\"> [value]\">&gt; [value]</option>"; echo "<option value=\"<= [value]\">&lt;= [value]</option>"; echo "<option value=\">= [value]\">&gt;= [value]</option>"; echo "</select>"; echo "</td>"; echo "<td><input name='_q[no]'></td>"; echo "<td>"; echo "<select name='_andor[no]'>"; echo "<option value=''>- ignore</option>"; echo "<option value='and' selected>AND</option>"; echo "<option value='or'>OR</option>"; echo "</select>"; echo "</td>"; echo "</tr>"; echo "<tbody id='r'></tbody>"; echo "</table>"; ?> <?php if(isset($_GET['q']) && $_GET['q'] !=""){ if(!isset($test)){ $test=escape($_GET['q'])." and";} preg_match_all("#`([a-z0-9\-\_]+)` ([\!\=\>\<|like|IS]+) (.*?) (and|or)#si", $test, $out); if(count($out[0])){ foreach($out[0] as $key => $val){ $out[3][$key]=trim($out[3][$key]); $out[2][$key]=trim($out[2][$key]); if($out[2][$key]=="IS" && $out[3][$key]=="NULL"){ $out[2][$key]="IS NULL"; $out[3][$key]="";} elseif(substr($out[3][$key], 0, 2)=="'%" && substr($out[3][$key], -2)=="%'" && $out[2][$key]=='like'){ $out[2][$key]="".$out[2][$key]." '%[value]%'"; $out[3][$key]=substr($out[3][$key], 2); $out[3][$key]=substr($out[3][$key], 0, -2);} elseif(substr($out[3][$key], 0, 1)=="'" && substr($out[3][$key], -1)=="'"){ $out[2][$key]="".$out[2][$key]." '[value]'"; $out[3][$key]=substr($out[3][$key], 1); $out[3][$key]=substr($out[3][$key], 0, -1);} else { $out[2][$key]="".$out[2][$key]." [value]";} echo "<script>addNewRow('s','r',null, '".rawurlencode($out[1][$key])."', '".rawurlencode($out[2][$key])."', '".rawurlencode($out[3][$key])."','".rawurlencode($out[4][$key])."');</script>\n";} } else { echo "<script>addNewRow('s','r',null, null, null, null,'and');</script>";} } else { ?> <script>addNewRow('s','r',null, null, null, null,'and');</script> <?php } ?> <input type='button' onclick="addNewRow('s','r',null, null, null, null,'and');" value=" Add new Search "> <br><br><br> <input type='submit' value=' Search '> </form> <?php } if(isset($_GET['page']) && base64_encode($_GET['page'])=="c2hvd19kYXRh" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(!isset($_GET['pg'])){ $_GET['pg']=1;} $start=($_GET['pg'] - 1) * 60; echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "<body><script>var newLoc='?page=show_options&table=".$_GET['table']."'; if(window.top.frames['topFrame'].location.toString().indexOf(newLoc)==-1){ window.top.frames['topFrame'].location=newLoc;} </script>"; $sql="select count(*) from `".$_GET['table']."`"; $q_link=""; if(isset($_GET['q']) && $_GET['q']!=''){ $_GET['q']=escape($_GET['q']); $sql2="select * from `".$_GET['table']."` where ".$_GET['q']." limit ".$start.",60"; $sql="select count(*) from `".$_GET['table']."` where ".$_GET['q'].""; $q_link="&q=".rawurlencode($_GET['q']);} $res=$db->query($sql); $total_rows=$db->result($res, 0, 0); $pagination=array(); for($a=1; $a <= ceil($total_rows / 60); $a++){ $pagination[]="<a ".($a==$_GET['pg'] ? "style='font-weight: bold;'":"")." href='?page=show_data&table=".$_GET['table']."&pg=".$a."".$q_link."'>".$a."</a>";} echo "".$_SESSION['username']."@".$_SESSION['host'] . " &gt; " .$_SESSION['database'] . " &gt; ".$_GET['table']."<br><br>"; echo "<br><br><strong>".$_GET['table']."</strong><br><br>"; if(isset($sql2)){ echo "<div style='border:1px solid #ccc; background-color: #e5e5e5; width: 100%; float: left;'>"; echo "<div style='float: left; padding:10px; '>"; echo "<strong>".$sql2."</strong><br><br>"; echo "<a href='?page=search&q=".urlencode($_GET['q'])."&table=".$_GET['table']."'>Edit Search</a>"; echo "</div>"; echo "</div>";} $sql="show index from `".$_GET['table']."`"; $res=$db->query($sql); $keys=array(); while($index_data=$db->fetch($res)){ $keys[]=$index_data['Column_name'];} $show=$total_rows - $start; if($show > 60){ $show=60;} echo "<hr>"; echo "Showing ".$show." rows of ".$total_rows." starting at ".$start."<br>"; echo "<hr>"; echo implode(" | ", $pagination); echo "<hr>"; echo "<table class='tablestyle'>"; $sql="show columns from `".$_GET['table']."`"; $res=$db->query($sql); echo "<tr class='head'>"; while($table_info=$db->fetch($res)){ echo "<td>".$table_info['Field']." &nbsp;</td>";} echo "<td colspan=2>&nbsp;</td>"; echo "</tr>"; $sql="select * from `".$_GET['table']."` limit ".$start.",60"; if(isset($_GET['q']) && $_GET['q']!=''){ $sql="select * from `".$_GET['table']."` where ".$_GET['q']." limit ".$start.",60";} $res=$db->query($sql); while($data=$db->fetch($res)){ echo "<tr>"; $where=array(); $where_url=""; foreach($data as $field => $val){ echo "<td>".htmlentities(substr($val, 0, 255))."</td>"; if(count($keys)){ if(in_array($field, $keys)){ $where_url .= "&where[".$field."]=".md5($val)."";} } else { if($val === NULL){ $where_url .= "&where[".$field."]=null";} else { $where_url .= "&where[".$field."]=".md5($val)."";} } } if($where_url){ echo "<td><a href='?page=edit&table=".$_GET['table']."&pg=".$_GET['pg']."".$where_url."'>Edit</a></td>"; echo "<td><a onclick=\"return window.confirm('Are you sure you want to delete this row?');\" href='?page=delete&table=".$_GET['table']."&pg=".$_GET['pg']."".$where_url."' target='topFrame'>Delete</a></td>";} echo "</tr>";} echo "</table>"; echo "<hr>"; echo implode(" | ", $pagination); echo "<hr>";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="c2hvd19vcHRpb25z" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}$offset=3600 * 24; header("Expires: " . gmdate("D, d M Y H:i:s", time() + $offset) . " GMT", true); header("Cache-Control: max-age=".$offset.", must-revalidate", true); header("Last-Modified: ". gmdate('D, d M Y H:i:s', filemtime(__FILE__) )." GMT", true); header("Pragma: Cache",true); echo "<html><head><meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "<link rel='stylesheet' href='?page=css' type='text/css'></head>"; echo "<body bgcolor='#9999cc' style='margin: 0px; margin-left: 20px;'>"; echo "<div style='float: left; width: 100%; height: 70px;'><h1>Table: `".$_GET['table']."`</h1></div>"; echo "<a target='contentFrame' href='?page=edit&table=".$_GET['table']."&pg=1' class='button'>Insert</a>"; echo "<a target='contentFrame' href='?page=show_data&table=".$_GET['table']."' class='button'>Browse</a>"; echo "<a target='contentFrame' href='?page=show_structure&table=".$_GET['table']."' class='button'>Structure</a>"; echo "<a target='contentFrame' href='?page=search&table=".$_GET['table']."' class='button'>Search</a>"; echo "<a target='contentFrame' href='?page=sql&table=".$_GET['table']."&pg=1' class='button'>SQL</a>"; echo "<a target='contentFrame' href='?page=new-table&table=".$_GET['table']."' class='button'>Alter Table</a>"; echo "<a target='contentFrame' href='?page=export&table=".$_GET['table']."' class='button'>Export</a>"; echo "<a target='contentFrame' href='?page=truncate&table=".$_GET['table']."' class='button'>Truncate</a>"; echo "<a target='contentFrame' href='?page=drop&table=".$_GET['table']."' class='button'>Drop</a>"; echo "</body></html>";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="c2hvd19zdHJ1Y3R1cmU=" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_GET['table'])){ echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<body><script>var newLoc='?page=show_options&table=".$_GET['table']."'; if(window.top.frames['topFrame'].location.toString().indexOf(newLoc)==-1){ window.top.frames['topFrame'].location=newLoc;} </script>"; echo "".$_SESSION['username']."@".$_SESSION['host'] . " &gt; " .$_SESSION['database'] . " &gt; ".$_GET['table']."<br><br>"; echo "<br><br><strong>".$_GET['table']."</strong><br><br>"; $sql="show columns from `".$_GET['table']."`"; $res=$db->query($sql); echo "<table class='tablestyle'>"; echo "<tr class='head'>"; echo "<td>Field</td>"; echo "<td>Type</td>"; echo "<td>Null</td>"; echo "<td>Key</td>"; echo "<td>Default</td>"; echo "<td>Extra</td>"; echo "</tr>"; while($table_info=$db->fetch($res)){ echo "<tr>"; echo "<td>".$table_info['Field']." &nbsp;</td>"; echo "<td>".$table_info['Type']." &nbsp;</td>"; echo "<td>".$table_info['Null']." &nbsp;</td>"; echo "<td>".$table_info['Key']." &nbsp;</td>"; echo "<td>".$table_info['Default']." &nbsp;</td>"; echo "<td>".$table_info['Extra']." &nbsp;</td>"; echo "</tr>\n";} echo "</table><br><br>"; echo "<a href='?page=new-table&table=".$_GET['table']."'>Alter Table</a>"; echo "<br><br>"; $sql="SHOW INDEX FROM `".$_GET['table']."`"; $res=$db->query($sql); echo "<hr>"; echo "<strong>Indexes</strong><br>"; echo "<table class='tablestyle'>"; echo "<tr class='head'>"; echo "<td>Non_unique</td>"; echo "<td>Key_name</td>"; echo "<td>Seq_in_index</td>"; echo "<td>Column_name</td>"; echo "<td>Collation</td>"; echo "<td>Cardinality</td>"; echo "<td>Sub_part</td>"; echo "<td>Packed</td>"; echo "<td>Index_type</td>"; echo "<td>Comment</td>"; echo "</tr>"; while($index=$db->fetch($res)){ echo "<tr>"; echo "<td>".$index['Non_unique']."</td>"; echo "<td>".$index['Key_name']."</td>"; echo "<td>".$index['Seq_in_index']."</td>"; echo "<td>".$index['Column_name']."</td>"; echo "<td>".$index['Collation']."</td>"; echo "<td>".$index['Cardinality']."</td>"; echo "<td>".$index['Sub_part']."</td>"; echo "<td>".$index['Packed']."</td>"; echo "<td>".$index['Index_type']."</td>"; echo "<td>".$index['Comment']."</td>"; echo "</tr>";} echo "</table>"; echo "</body>";} } if(isset($_GET['page']) && base64_encode($_GET['page'])=="c3Fs" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}$query=""; if(isset($_GET['query'])){ $query=escape($_GET['query']);} if(isset($_POST['query'])){ $query=escape($_POST['query']);} $query=trim($query); echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "<h1>SQL Query</h1>"; echo "<form action=\"".$_SERVER['REQUEST_URI']."\" method='post'>"; echo "<textarea style='width: 80%;' rows='8' name=\"query\" placeholder=\"select * from `".$_GET['table']."`\">".htmlentities($query)."</textarea><br>"; echo "<input type='submit' value=' Run Query '>"; echo "</form>"; if(strpos($query, ";") !== false && strpos($query, "\n") !== false){ $lines=explode("\n", $query); $a=""; echo "Running: ".count($lines)." queries.<br><br>"; for($i=0; $i < count($lines); $i++){ if(substr(trim($lines[$i]), 0, 1)=="-" && $a==""){ echo $lines[$i]."<br>";} else { $a .= trim($lines[$i]); if(substr($a, -1)==";"){ $db->query($a); echo htmlentities($a)."<br><br>"; $a=""; if($db->error()){ echo $db->error(); $i=count($lines);} } } } } else if(substr(strtolower($query), 0, 7)=="select " || substr(strtolower($query), 0, 5)=="show "){ $sql=$query; $res=$db->query($sql); if($db->error()){ echo $db->error()."<br><br>"; echo htmlentities($sql)."<br>";} else { if($db->num_rows($res)){ echo "<table class='tablestyle'>"; $data=$db->fetch($res); echo "<tr class='head'>"; foreach($data as $key => $value){ echo "<td>".$key."</td>";} echo "</tr>"; do { echo "<tr>"; foreach($data as $key => $value){ echo "<td>".htmlentities($value)."</td>";} echo "</tr>";} while($data=$db->fetch($res)); echo "</table>";} else { echo "No results found.";} } } elseif(substr(strtolower($query), 0, 7)=="delete " || substr(strtolower($query), 0, 5)=="drop " || substr(strtolower($query), 0, 9)=="truncate "){ if(isset($_POST['yes'])){ $sql=$query; $db->query($sql); if($db->error()){ echo $db->error()."<br><br>"; echo htmlentities($sql)."<br>";} else { echo "Rows affected: ".mysql_affected_rows()."<br><br>"; if(substr(strtolower($query), 0, 5)=="drop "){ echo "<script>window.top.frames['left'].location=window.top.frames['left'].location;</script>";} } } else { echo nl2br(htmlentities($query))."<br><br>"; echo "Are you sure you want to run this query?<br>"; echo "<br>"; echo "<form action='".$_SERVER['REQUEST_URI']."' method='post'>"; echo "<div style='display: none'><textarea name='query'>".$query."</textarea></div>"; echo "<input type='submit' name='yes' value=' Run Anyway '> <input type='button' onclick=\"self.location='?page=sql'\" value=' Cancel '>"; echo "</form>";} } elseif(substr(strtolower($query), 0, 7)=="update "){ if(isset($_POST['yes']) || preg_match("#where#si", $query)){ $sql=$query; $db->query($sql); if($db->error()){ echo $db->error()."<br><br>"; echo htmlentities($sql)."<br>";} else { echo "Rows affected: ".mysql_affected_rows()."<br><br>";} } else { echo nl2br(htmlentities($query))."<br><br>"; echo "<b>WHERE</b> is missing in this query, are you sure you want to run this query?<br>"; echo "<br>"; echo "<form action='".$_SERVER['REQUEST_URI']."' method='post'>"; echo "<div style='display: none'><textarea name='query'>".$query."</textarea></div>"; echo "<input type='submit' name='yes' value=' Run Anyway '> <input type='button' onclick=\"self.location='?page=sql'\" value=' Cancel '>"; echo "</form>";} } elseif(substr(strtolower($query), 0, 12)=="create table"){ $db->query($query); if(!$db->error()){ echo "The table has been created.<br>"; echo "<script>window.top.frames['left'].location=window.top.frames['left'].location;</script>";} } elseif(trim($query)){ $sql=$query; $db->query($sql); if($db->error()){ echo $db->error()."<br><br>"; echo htmlentities($sql)."<br>";} else { echo "Rows affected: ".mysql_affected_rows()."<br><br>";} } } if(isset($_GET['page']) && base64_encode($_GET['page'])=="dG9w" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}?> <body bgcolor="#9999cc"> </body> <?php } if(isset($_GET['page']) && base64_encode($_GET['page'])=="dHJ1bmNhdGU=" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_POST) && isset($_POST['yes'])){ $db->query("truncate table `".$_GET['table']."`"); header("location: ?page=show_data&table=".$_GET['table'].""); exit();} echo "<form method=\"post\" action=\"".$_SERVER['REQUEST_URI']."\">"; echo "<link rel='stylesheet' href='?page=css' type='text/css'>"; echo "<meta http-equiv=\"content-type\" content=\"text/html;charset=iso-8859-1\">"; echo "TRUNCATE TABLE `".$_GET['table']."`<br>"; echo "<br>"; echo "<h3>All the data from this table (".$_GET['table'].") will be deleted, are you sure?</h3><br>"; echo "<input type='submit' value=' Yes ' name='yes'> &nbsp; &nbsp; &nbsp; <input type='button' onclick=\"window.location='?page=show_data&table=".$_GET['table']."'\" value=' Cancel '>"; echo "</form>";} if(isset($_GET['page']) && base64_encode($_GET['page'])=="dXBkYXRl" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}if(isset($_GET['where'])){ $where=array(); if(is_array($_GET['where'])){ foreach($_GET['where'] as $key => $value){ if($value=="null"){ } else { $where[]="md5(`".$key."`)='".($value)."'";} } } } if($_POST['data']){ $sql=array(); foreach($_POST['data'] as $field => $value){ $value="'".addslashes(escape($value))."'"; if($_POST['funcList']){ $value="".$_POST['funcList'][$field]."(".$value.")";} $sql[]="`".$field."`=".$value."";} } $sql="update `".$_GET['table']."` set ".implode(",",$sql)." where ".implode(" AND ",$where).""; $db->query($sql); header("Location: ?page=show_data&table=".$_GET['table']."&pg=".$_GET['pg'].""); exit();} if(isset($_GET['page']) && base64_encode($_GET['page'])=="d2VsY29tZQ==" && isset($hash) && isset($hash2) && $hash==$hash2){ if(!isset($_SESSION['host']) && isset($_GET['page']) && $_GET['page'] !="" && $_GET['page'] !="css"){ $_SERVER['REQUEST_URI']=str_replace("page=","goto=",$_SERVER['REQUEST_URI']); header("location: ".$_SERVER['REQUEST_URI'].""); exit();}?> <link rel="stylesheet" href="?page=css" type="text/css"> <h2>Welcome</h2> This is a free version to manage your MySQL database in one file.<br> <br> <br> <p>This script may be used for private or commercial use, but can't be sold or changed without my permissions. If you like to donate, please <a target='_top' href='http://www.js-systems.nl'>click here.</a></p> <p>Buy me a beer or a cup of coffee.</p> <p>Thank you for using this and keeping the open-source community strong!</p> <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top"> <input type="hidden" name="cmd" value="_s-xclick" /> <input type="hidden" name="hosted_button_id" value="TV9EQZFE68XAG" /> <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" /> <img alt="" border="0" src="https://www.paypal.com/en_CA/i/scr/pixel.gif" width="1" height="1" /> </form> <br><br><br><br> <a href="https://wwww.slomp.ca" target="_top">Copyright by Slomp Technologies</a> <?php } 
